[[{"l":"PowerShellScripting Documentation Site","p":["A collection of PowerShell scripts for enterprise IT administration, covering Active Directory, Microsoft 365, Exchange Online, Entra ID, and Intune management tasks that i've created over the years.","License: GPL v3 PowerShell Gallery Platform"]},{"l":"Table of Contents","p":["Accessibility","Authentication","Basic Usage","Changelog","Common Issues","Configuration","Contact and Support","Contributing","Core Functionality","Customisation","Development Environment","Development Guidelines","Environment Variables","Features","Folder Structure","Getting Help","Getting Started","Installation","Interactive Scripts","Key Scripts","License","Like to say thank you?","Logging and Troubleshooting","Logging Standards","Modules and Functions","Prerequisites","Project Maintainer","Recent Updates","Script Categories","Support Guidelines","Support Resources","Testing","Usage","Validation","Version History"]},{"l":"Features","p":["Scripts for:","Active Directory Management: User creation, group management, computer organisation, and bulk operations","Microsoft 365 Administration: Exchange Online mailbox management, quarantine handling, and transport rules","Entra ID Integration: External user management, compromised account remediation, and identity operations","Intune Device Management: Bulk device synchronisation, remediation scripts, and compliance monitoring","General Utilities: Password generation, module management, and script selection tools","OneDrive Administration: User content download and management capabilities","Comprehensive Logging: Standardised logging across all scripts with detailed audit trails","Error Handling: Robust error handling and retry logic for enterprise environments","GUI Interfaces: User-friendly forms for complex administrative tasks"]},{"l":"Getting Started"},{"l":"Prerequisites","p":["PowerShell 7.0 or later","Windows operating system","Appropriate administrative permissions for target systems","Required PowerShell modules (see individual scripts for specific requirements):","Active Directory Module","Exchange Online Management","Microsoft Graph PowerShell SDK","Microsoft.Graph.Intune","MSOnline (where applicable)"]},{"l":"Installation","p":["Clone the repository:","Navigate to the project directory:","Review the script you want to use and install any required modules:","Note: Most scripts will check for required modules when run.","Configure the scripts according to your environment (see Configuration section)"]},{"l":"Usage"},{"l":"Basic Usage","p":["Each script is designed to be run independently. Navigate to the appropriate folder and execute the script:"]},{"l":"Script Categories","p":["Details of all scripts, and links to their documentation, can be found in Scripts.","Active Directory: Scripts for user and computer management in on-premises AD environments","Exchange 365: Email and mailbox management for cloud and hybrid environments","Entra ID: Identity and access management for Azure AD/Entra ID","General: Utility scripts for common administrative tasks","Intune: Detection and remediation scripts to keep your house in order","Microsoft 365: Microsoft 365 Relevant scripts","Onedrive: Onedrive for Business and SharePoint bulk file upload/download scripts"]},{"l":"Interactive Scripts","p":["Many scripts include GUI interfaces for ease of use:","User creation wizards with form-based input","Device selection interfaces","Progress indicators for long-running operations"]},{"l":"Configuration"},{"l":"Environment Variables","p":["Some scripts may require environment-specific configuration. Review each script's header for specific requirements."]},{"l":"Authentication","p":["Ensure you have appropriate administrative credentials","Some scripts require multi-factor authentication (MFA)","Consider using application passwords where applicable"]},{"l":"Customisation","p":["Scripts include configurable parameters at the top of each file. Common customisations include:","Domain names and organisational units","Email domains and Exchange settings","Logging paths and retention policies","Timeout values and retry attempts"]},{"l":"Folder Structure"},{"l":"Modules and Functions"},{"l":"Core Functionality","p":["The scripts in this collection provide:","User Management: Creation, modification, and departure processing","Group Management: Membership copying and bulk operations","Device Management: Synchronisation, detection, and remediation","Security Operations: Compromised account handling and compliance monitoring","Utility Functions: Password generation, module management, and system utilities"]},{"l":"Key Scripts","p":["User-Creation.ps1: Comprehensive user creation with GUI interface","Intune-BulkSync.ps1: Mass device synchronisation for Intune environments","AutomateCompromisedAccountRemediation.ps1: Automated security response","ScriptSelector.ps1: Interactive menu system for script selection"]},{"l":"Testing"},{"l":"Development Environment","p":["Testing scripts are located in the testing/ folder and include:","Proof-of-concept implementations","Version comparisons","Experimental features"]},{"l":"Validation","p":["Before using scripts in production:","Review the script header for version information and changelog","Test in a non-production environment","Verify all required modules are installed","Check logging output for any warnings or errors"]},{"l":"Logging and Troubleshooting"},{"l":"Logging Standards","p":["All scripts follow consistent logging practices:","Log files stored in $env:TEMP with timestamps","Comprehensive error logging with context","Success and failure reporting","Progress indicators for long-running operations"]},{"l":"Common Issues","p":["Module Import Errors: Ensure required PowerShell modules are installed","Authentication Failures: Verify credentials and MFA settings","Permission Errors: Check administrative rights for target systems","Network Connectivity: Ensure access to required cloud services"]},{"l":"Support Resources","p":["Check script headers for specific documentation links","Review Microsoft documentation for API changes","Consult PowerShell Gallery for module updates"]},{"l":"Accessibility","p":["This project is committed to accessibility and inclusive design:","Scripts include progress indicators and clear status messages","Documentation uses descriptive text for all functionality","Error messages provide actionable guidance","GUI interfaces follow accessibility best practices","All documentation supports screen readers"]},{"l":"Contributing","p":["Contributions to improve and expand this script collection are welcome. Please read the contribution guidelines:","Code Standards: Follow PowerShell best practices and existing code style","Documentation: Include comprehensive headers and inline comments","Testing: Validate scripts in appropriate test environments","Security: Ensure no hardcoded credentials or sensitive information"]},{"l":"Development Guidelines","p":["Use Australian English (EN-AU) for documentation and comments","Include proper error handling and logging","Follow the established folder structure","Update this README when adding new functionality"]},{"l":"Changelog"},{"l":"Recent Updates","p":["$logsToClear: List of event logs to process.","0 = Success","1 = General failure (useful for external monitoring; individual step failures do not necessarily change the final exit code unless a fatal condition is detected).","Added DISM component store cleanup (StartComponentCleanup) with explicit exit-code logging.","Added initialisation of $freeSpaceGB to capture baseline free space before cleanup, ensuring accurate space-recovered reporting.","Added removal of old user profiles from C:\\Users based on retention days ($userProfileRetentionDays).","Added removal of user-specific temporary files (%USERPROFILE%\\AppData\\Local\\Temp).","Appended new logs to existing archive files or created new archive files as needed.","Centralised logging with Start-Transcript and Custom-WriteLog; log file located at $env:TEMP<scriptName>.log.","Configured and triggered Storage Sense to remove temporary files and locally cached OneDrive content.","Documented exit codes:","Enhanced event log cleanup:","Executed Disk Cleanup silently using the /VERYLOWDISK argument.","Exposed configuration variables for operational tuning:","Improved error handling for individual logs to ensure the script continues processing other logs.","Improved error handling so individual step failures are logged as warnings and the script continues.","Integrated CleanMgr registry preparation for selected VolumeCaches and invoked CleanMgr (/sagerun:1).","Validated archive directory existence before appending or moving logs."]},{"l":"Version History","p":["See individual script headers for detailed version history and changelog information."]},{"l":"License","p":["This project is licensed under the GNU General Public License v3.0 - see the LICENSE file for details.","Copyright (c) 2025, Michael Harris, All rights reserved."]},{"l":"Like to say thank you?","p":["If these scripts have helped you in your IT administration tasks, consider:","⭐ Starring this repository","\uD83D\uDC1B Reporting issues or suggesting improvements","\uD83D\uDCD6 Contributing to the documentation","☕ Buy me a coffee to support continued development"]},{"l":"Contact and Support"},{"l":"Project Maintainer","p":["Michael Harris- @twcau"]},{"l":"Getting Help","p":["Issues: Report bugs or request features via GitHub Issues","Discussions: Join the conversation in GitHub Discussions","Documentation: Review script headers and Microsoft documentation links"]},{"l":"Support Guidelines","p":["Provide clear descriptions of issues with relevant log files","Include PowerShell version and module information","Specify the target environment (on-premises, cloud, hybrid)","Follow the issue templates when reporting problems","This project follows Microsoft PowerShell best practices and maintains compatibility with enterprise IT environments."]}],[{"l":"Scripts","p":["Below is an organised list of all scripts, grouped by module/folder. Each script name links to its associated documentation.","ad","ad/computer","ad/user/creation","ad/user/reconcillation","e365","entra","general","general/module-management","general/password-generation","intune","intune/devices","intune/remediation","onedrive"]},{"l":"ad"},{"l":"ad/computer","p":["Script","Description","FindMachineOU.ps1","Locates the organisational unit (OU) for a given computer in Active Directory."]},{"l":"ad/user/creation","p":["Script","Description","AD-CopyGroups.ps1","Copies group memberships from one AD user to another.","User-Creation-Bulk.ps1","Bulk creation of AD users from a CSV file.","User-Creation.ps1","Creates a new AD user with a GUI interface.","User-Departure.ps1","Processes the departure of an AD user, disabling and archiving the account."]},{"l":"ad/user/reconcillation","p":["Script","Description","AD-Bulk-DepartedEmployeeReconcillation.ps1","Bulk reconciliation of departed employees in AD.","Employee-Departure-Reconciliation.ps1","Reconciles a single departed employee in AD.","Employee-Listing.ps1","Lists employees in AD for reporting or reconciliation."]},{"l":"e365","p":["Script","Description","E365-Mailbox-ConvertToShared.ps1","Converts a user mailbox to a shared mailbox in Exchange Online.","E365-Quarantine-ExportRecord.ps1","Exports quarantine records from Exchange Online.","Exchange-QuarantineTABL-DataDownload.ps1","Downloads quarantine data from Exchange Online for analysis.","NewTransportRuleExecName.ps1","Creates or manages Exchange Online transport rules."]},{"l":"entra","p":["Script","Description","AutomateCompromisedAccountRemediation.ps1","Automates remediation steps for compromised Entra ID (Azure AD) accounts.","Entra-UserExternal-Create.ps1","Creates an external user in Entra ID (Azure AD).","User-Management-External.ps1","Manages external users in Entra ID (Azure AD)."]},{"l":"general","p":["Script","Description","ScriptSelector.ps1","Provides an interactive menu to select and launch other scripts."]},{"l":"general/module-management","p":["Script","Description","Module-PowerShell7-Require.ps1","Ensures required PowerShell 7 modules are installed and imported.","Update-Module.ps1","Updates specified PowerShell modules to the latest version."]},{"l":"general/password-generation","p":["Script","Description","Password-Generator-Silent.ps1","Generates a password silently for use in automation.","Password-Generator.ps1","Generates a password with user interaction or options."]},{"l":"intune"},{"l":"intune/devices","p":["Script","Description","Intune-BulkSync.ps1","Performs bulk synchronisation of devices in Microsoft Intune."]},{"l":"intune/remediation","p":["Script","Description","M365-Version","Detects and remediates the version of Microsoft 365 Apps installed on devices.","Teams-Old","Detects and remediates legacy Microsoft Teams installations.","WinUpdate-23H2to24H2Force","Detects and remediates Windows 10/11 devices ready for forced update from 23H2 to 24H2.","WinUpdate-Outstanding","Detects and remediates Windows Update status on devices.","WinUpdate-Pause","Detects and remediates if Windows Update is paused on devices.","Win-Storage.ps1","Detects devices with low storage space."]},{"l":"onedrive","p":["Script","Description","None at this time"]}],[{"l":"FindMachineOU.ps1"},{"l":"Purpose","p":["Interactively locates one or more computers in Active Directory by DNS name or partial name, and displays their distinguished name (OU) and other details. Useful for resolving naming conflicts or verifying machine location in AD."]},{"l":"Function","p":["Prompts the user to enter a machine name or partial name (via Read-Host).","Searches Active Directory for computers whose DNSHostName matches the input (using Get-ADComputer).","Displays results in a formatted table: DisplayName, Name, DistinguishedName.","Waits for user to press Enter before exiting.","Handles connection to Exchange/AD if required (with fallback logic for session import)."]},{"l":"Usage","p":["The script is interactive and does not require command-line parameters."]},{"l":"Inputs","p":["User input: Machine name or partial name (prompted at runtime)."]},{"l":"Variables","p":["$machineName: Stores the user-provided machine name or partial name.","$scriptComplete: Tracks script completion state."]},{"l":"Command Line Flags","p":["None. All input is provided interactively."]},{"l":"Outputs","p":["Displays a table of matching AD computers, including DisplayName, Name, and DistinguishedName (OU path).","If no matches are found, the table will be empty."]},{"l":"Notes","p":["Requires the Active Directory module ( Get-ADComputer).","Loads Windows Forms assembly for compatibility, but does not use GUI elements.","Attempts to connect to Exchange/AD if not already connected (fallback logic included).","Useful for troubleshooting machine naming conflicts or verifying AD structure."]}],[{"l":"AD-CopyGroups.ps1"},{"l":"Purpose","p":["Interactively copies group memberships and key attributes from one Active Directory user (source) to another (target), with options to reset password, clear existing memberships, and move the target user to the correct OU. Ensures baseline group membership and removes non-standard groups as required."]},{"l":"Function","p":["Prompts for the source user (by login, UPN, email, or display name) and validates existence in AD.","Prompts for the target user and validates existence in AD.","Presents a menu:","Copy roles (with option to clear existing roles)","Re-enable account and copy roles (for departed users, including OU move, password reset, and group cleanup)","Exit","Optionally enables the target account, moves it to the correct OU, and prompts for missing attributes (EmployeeID, Manager, Title, Department).","Optionally resets the password and forces change at next login.","Optionally removes all existing group memberships from the target account (except Domain Users).","Copies all group memberships from the source to the target account.","Ensures the target is a member of required base groups (e.g., All Staff) and removes from non-standard signature groups.","Displays completion message and exits."]},{"l":"Usage","p":["The script is fully interactive and does not require command-line parameters."]},{"l":"Inputs","p":["User input: Source and target user names (login, UPN, email, or display name)","Menu selections for actions (copy roles, re-enable, exit)","Prompts for missing attributes (EmployeeID, Manager, Title, Department)","Prompts for password reset and group membership removal (yes/no)"]},{"l":"Variables","p":["$userNameFrom, $userNameTo: Usernames for source and target","$SamAccountNameFrom, $SamAccountNameTo: Resolved sAMAccountNames","$orgUnitLocationFrom, $orgUnitLocationTo: Distinguished names (OU paths)","$scriptComplete: Script completion state","$targetOU: Target OU for active users"]},{"l":"Command Line Flags","p":["None. All input is provided interactively."]},{"l":"Outputs","p":["Writes status and results to the console (group membership changes, OU moves, attribute updates)","Displays completion and error messages","Logs group additions/removals and attribute changes"]},{"l":"Notes","p":["Requires the Active Directory module ( Get-ADUser, Add-ADGroupMember, etc.)","Requires Exchange Online connectivity for mailbox actions","Handles input sanitisation for AD queries","Ensures robust error handling and user prompts for all critical actions"]}],[{"l":"User-Creation-Bulk.ps1","p":["NOTE: This script is not even close to ready for prime time."]},{"l":"Purpose","p":["Automates the bulk creation of Active Directory user accounts with a graphical user interface (GUI). Collects user information, validates input, generates a random password, creates the AD user, configures mailbox, group memberships, employee ID, and organisational structure. Supports both single and bulk user creation (bulk via button for new hire sheet import)."]},{"l":"Function","p":["Loads required modules (Active Directory, Exchange Online Management).","Presents a Windows Forms GUI for user input (first name, last name, employee ID, manager, mirror user, job title, department).","Validates all fields before allowing user creation.","Generates a random password using an external password generator script.","Creates the AD user with all required attributes and home directory.","Copies group memberships from a specified mirror user.","Enables an Exchange Online mailbox for the new user.","Ensures membership in required base groups and removes from non-standard signature groups.","Displays the new credentials in a pop-up and copies the password to clipboard.","Includes buttons to clear fields and to bulk create users from a new hire sheet (Excel import logic placeholder)."]},{"l":"Usage","p":["The script is fully interactive and uses a GUI. No command-line parameters are required for standard use."]},{"l":"Inputs","p":["User input via GUI: First Name, Last Name, Employee ID, Manager, Mirror User, Job Title, Department (dropdown)","Bulk import: Button for new hire sheet (Excel import logic placeholder)"]},{"l":"Variables","p":["$textBoxFirstName, $textBoxLastName, etc.: GUI field objects","$password: Generated password for new user","$groupNamesAdd, $groupNamesRemove: Groups to add/remove for baseline membership","$sharePointFilePath, $localExcelPath: Paths for bulk import (future use)"]},{"l":"Command Line Flags","p":["None for standard use. (Bulk import logic may use file paths in future.)"]},{"l":"Outputs","p":["Creates new AD user accounts and home directories","Copies group memberships from mirror user","Enables Exchange Online mailbox","Ensures correct group memberships","Displays credentials in pop-up and copies password to clipboard","Logs actions and errors to the console and pop-ups"]},{"l":"Notes","p":["Requires the Active Directory and Exchange Online Management modules","Uses an external password generator script (dot-sourced)","GUI-based; not suitable for headless environments","Bulk import from Excel/SharePoint is planned but not yet implemented"]}],[{"l":"User-Creation.ps1","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Automates the creation of Active Directory user accounts with a graphical user interface (GUI). Collects user information, validates input, generates a random password, creates the AD user, configures mailbox, group memberships, employee ID, and organisational structure. Provides user feedback and password delivery via pop-ups and clipboard."]},{"l":"Dependencies","p":["Active Directory module( Microsoft Docs)","Exchange Online Management module( Microsoft Docs)","Windows Forms(part of .NET, used for GUI)","Password-Generator-Silent.ps1(local script, must be accessible and dot-sourced)"]},{"l":"Function","p":["Loads required modules (Active Directory, Exchange Online Management).","Presents a Windows Forms GUI for user input (first name, last name, employee ID, manager, mirror user, job title, department).","Validates all fields before allowing user creation.","Generates a random password using an external password generator script.","Creates the AD user with all required attributes and home directory.","Copies group memberships from a specified mirror user.","Enables an Exchange Online mailbox for the new user.","Ensures membership in required base groups and removes from non-standard signature groups.","Displays the new credentials in a pop-up and copies the password to clipboard.","Includes buttons to clear fields for ease of repeated use."]},{"l":"Usage","p":["The script is fully interactive and uses a GUI. No command-line parameters are required for standard use."]},{"l":"Inputs","p":["User input via GUI: First Name, Last Name, Employee ID, Manager, Mirror User, Job Title, Department (dropdown)"]},{"l":"Variables","p":["$textBoxFirstName, $textBoxLastName, $textBoxEmployeeID, $textBoxManager, $textBoxMirrorUser, $textBoxJobTitle, $comboBoxDepartment: GUI field objects","$password: Generated password for new user","$groupNamesAdd, $groupNamesRemove: Groups to add/remove for baseline membership"]},{"l":"Command Line Flags","p":["None for standard use."]},{"l":"Outputs","p":["Creates new AD user accounts and home directories","Copies group memberships from mirror user","Enables Exchange Online mailbox","Ensures correct group memberships","Displays credentials in pop-up and copies password to clipboard","Logs actions and errors to the console and pop-ups"]},{"l":"Notes","p":["Requires the Active Directory and Exchange Online Management modules","Uses an external password generator script (dot-sourced)","GUI-based; not suitable for headless environments"]}],[{"l":"User-Departure.ps1","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Automates the departure/offboarding of Active Directory user accounts with a graphical user interface (GUI). Collects required information, disables the account, moves it to the correct OU, removes user from distribution lists and key groups, updates Exchange mailbox, and triggers a delta sync for Azure AD. Designed for both single and bulk user processing."]},{"l":"Dependencies","p":["Active Directory module( Microsoft Docs)","Exchange Online Management module( Microsoft Docs)","Windows Forms(part of .NET, used for GUI)"]},{"l":"Function","p":["Loads required modules and presents a Windows Forms GUI for user input (full name or logon name).","Validates user existence in AD.","Resets the user's password to a default value.","Disables the AD account.","Hides the mailbox from the GAL and converts it to a shared mailbox.","Moves the user account to the \"Disabled Accounts\" OU.","Removes the user from distribution lists, E3/E1 license groups, signature, and KnowBe4 groups; re-adds to e1_office if needed.","Triggers a delta sync for Azure AD.","Provides user feedback via custom pop-up messages and focuses the form for rapid repeated use."]},{"l":"Usage","p":["The script is fully interactive and uses a GUI. No command-line parameters are required for standard use."]},{"l":"Inputs","p":["User input via GUI: Full Name or Logon Name"]},{"l":"Variables","p":["$textBoxFullName: GUI field for user input","$logonname: Derived logon name from full name","$groups: List of groups to remove the user from"]},{"l":"Command Line Flags","p":["None for standard use."]},{"l":"Outputs","p":["Disables the user account","Moves account to Disabled Accounts OU","Converts mailbox to shared and hides from GAL","Removes from key groups and distribution lists","Triggers Azure AD delta sync","Provides pop-up feedback for each step"]},{"l":"Notes","p":["Requires the Active Directory and Exchange Online Management modules","GUI-based; not suitable for headless environments","Manual check of mailbox conversion is recommended after script completion"]}],[{"l":"AD-Bulk-DepartedEmployeeReconcillation.ps1","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Automates the bulk reconciliation of departed employees in Active Directory using a CSV file from HR. Validates if each person is still active, disables accounts as needed, logs actions, and provides clear instructions for IT follow-up and asset checks."]},{"l":"Dependencies","p":["Active Directory module( Microsoft Docs)"]},{"l":"Function","p":["Prompts for and selects the correct CSV file from a designated folder.","Imports the CSV and iterates through each employee record.","For each employee:","Checks if the AD account is still active (enabled).","If active, disables the account and logs details (employee ID, name, manager, etc.) to a dated report file.","Sets a flag if any accounts were disabled.","At the end, provides actionable instructions for IT if any accounts were disabled, including asset and ticket checks.","Moves the processed CSV to a \"Complete\" folder and logs the operation."]},{"l":"Usage","p":["The script is fully interactive and does not require command-line parameters for standard use. It prompts for file selection and guides the user through the process."]},{"l":"Inputs","p":["User selection of CSV file from a folder (interactive prompt)","CSV file must contain at least a detnumber column (employee ID)"]},{"l":"Variables","p":["$directory: Folder containing CSV files","$csvPath: Path to the selected CSV file","$DestinationFolderReport: Path to the output report file","$infoWrittenToCSV: Flag indicating if any accounts were disabled"]},{"l":"Command Line Flags","p":["None for standard use."]},{"l":"Outputs","p":["Disables AD accounts for departed employees as needed","Logs details to a dated CSV report","Provides actionable instructions for IT follow-up if required","Moves processed CSV to a \"Complete\" folder"]},{"l":"Notes","p":["Requires the Active Directory module","CSV file must be placed in the correct folder and contain the required columns","Script provides clear error messages and instructions for each step"]}],[{"l":"Employee-Departure-Reconciliation.ps1","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Automates the reconciliation of a single departed employee in Active Directory using a CSV file from People Services. Validates if the person is still active, disables the account if needed, logs actions, and provides clear instructions for ICT follow-up and asset checks."]},{"l":"Dependencies","p":["Active Directory module( Microsoft Docs)"]},{"l":"Function","p":["Prompts for and selects the correct CSV file from a designated folder.","Imports the CSV and iterates through each employee record.","For each employee:","Checks if the AD account is still active (enabled).","If active, disables the account and logs details (employee ID, name, manager, etc.) to a dated report file.","Sets a flag if any accounts were disabled.","At the end, provides actionable instructions for ICT if any accounts were disabled, including asset and ticket checks.","Moves the processed CSV to a \"Complete\" folder and logs the operation."]},{"l":"Usage","p":["The script is fully interactive and does not require command-line parameters for standard use. It prompts for file selection and guides the user through the process."]},{"l":"Inputs","p":["User selection of CSV file from a folder (interactive prompt)","CSV file must contain at least a detnumber column (employee ID)"]},{"l":"Variables","p":["$directory: Folder containing CSV files","$csvPath: Path to the selected CSV file","$DestinationFolderReport: Path to the output report file","$infoWrittenToCSV: Flag indicating if any accounts were disabled"]},{"l":"Command Line Flags","p":["None for standard use."]},{"l":"Outputs","p":["Disables AD account for the departed employee as needed","Logs details to a dated CSV report","Provides actionable instructions for ICT follow-up if required","Moves processed CSV to a \"Complete\" folder"]},{"l":"Notes","p":["Requires the Active Directory module","CSV file must be placed in the correct folder and contain the required columns","Script provides clear error messages and instructions for each step"]}],[{"l":"Employee-Listing.ps1","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Automates the process of updating Employee IDs and Manager relationships in Active Directory using a CSV file from People Services. Handles error reporting, file selection, and provides actionable feedback for any issues encountered."]},{"l":"Dependencies","p":["Active Directory module( Microsoft Docs)"]},{"l":"Function","p":["Prompts for and selects the correct CSV file from a designated folder.","Imports the CSV and iterates through each employee record.","For each employee:","Updates the EmployeeID attribute in AD if the user is found.","Logs users not found to a dated report file.","Iterates through the CSV again to update Manager relationships for each employee.","Logs any issues with updating managers to the report file.","Moves the processed CSV to a \"Complete\" folder and provides user feedback."]},{"l":"Usage","p":["The script is fully interactive and does not require command-line parameters for standard use. It prompts for file selection and guides the user through the process."]},{"l":"Inputs","p":["User selection of CSV file from a folder (interactive prompt)","CSV file must contain at least detnumber(Employee ID) and detcurman(Manager Employee ID) columns"]},{"l":"Variables","p":["$directory: Folder containing CSV files","$csvPath: Path to the selected CSV file","$DestinationFolderReport: Path to the output report file","$infoWrittenToCSV: Flag indicating if any issues were logged"]},{"l":"Command Line Flags","p":["None for standard use."]},{"l":"Outputs","p":["Updates EmployeeID and Manager fields in AD","Logs users not found or manager update failures to a dated CSV report","Moves processed CSV to a \"Complete\" folder","Provides actionable feedback to the user"]},{"l":"Notes","p":["Requires the Active Directory module","CSV file must be placed in the correct folder and contain the required columns","Script provides clear error messages and instructions for each step"]}],[{"l":"E365-Mailbox-ConvertToShared.ps1","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Intended for hybrid environemnts - this script performs multiple actions to assist in mailbox cleanups, primarily when a user departs the organisation.","Specifically - it converts a user mailbox to a shared mailbox in Exchange Online (E365). Confirms user existence, matches on multiple AD attributes, connects to both on-prem and cloud Exchange, and performs the conversion interactively."]},{"l":"Dependencies","p":["Active Directory module( Microsoft Docs)","Exchange Online Management module( Microsoft Docs)","Windows Forms(part of .NET, used for pop-up feedback)"]},{"l":"Function","p":["Prompts for the user to convert (accepts login, UPN, email, or display name).","Searches AD for the user by SamAccountName, UserPrincipalName, EmailAddress, or Name.","Connects to on-prem Exchange and hides the mailbox from the GAL.","Connects to Exchange Online (cloud) and converts the mailbox to shared.","Provides pop-up and console feedback at each step."]},{"l":"Usage","p":["The script is fully interactive and does not require command-line parameters for standard use. It prompts for user input and guides the admin through the process."]},{"l":"Inputs","p":["User input via prompt: login, UPN, email, or display name of the mailbox to convert"]},{"l":"Variables","p":["$SamAccountNameFrom: The matched user's SamAccountName","$orgUnitLocationFrom: The matched user's AD distinguished name","$scriptComplete: Script completion flag"]},{"l":"Command Line Flags","p":["None for standard use."]},{"l":"Outputs","p":["Converts the specified mailbox to shared in Exchange Online","Hides the mailbox from the GAL in on-prem Exchange","Provides pop-up and console feedback for each step"]},{"l":"Notes","p":["Requires the Active Directory and Exchange Online Management modules","GUI-based pop-ups require Windows Forms","Script provides clear error messages and instructions for each step"]}],[{"l":"E365-Quarantine-ExportRecord.ps1","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Exports Microsoft 365 Exchange quarantine message records and Tenant Allow/Block List (TABL) data to CSV files for analysis. Supports cross-platform operation (Windows, macOS, Linux), robust error handling, and modern authentication (FIDO2/WebAuthn).","This is to assist email administrators in using an accompying XLS file to quickly reconcile domains in quarantine, which are not already in the Tenant Allow/Block List (TABL), and drive faster action for adding domains for blocking via TABL.","Previously downloaded CSV files are archived at the start of the script, to ensure these records can be kept if needed."]},{"l":"Dependencies","p":["PowerShell 7.0 or later( Install Guide)","Exchange Online Management module( Microsoft Docs)"]},{"l":"Function","p":["Detects operating system and sets cross-platform file paths for output and archiving.","Ensures required directories exist and archives previous CSV files with date-stamped names.","Validates PowerShell 7 environment and required modules, installing if needed.","Connects to Exchange Online using modern authentication.","Downloads up to 10,000 quarantine message records (paginated) and exports to quarantine.csv.","Downloads Tenant Allow/Block List (Sender type) and exports to tabl.csv.","Provides robust error handling, progress indication, and clear user feedback."]},{"l":"Usage","p":["The script is fully interactive and does not require command-line parameters for standard use. Output files are saved to platform-specific locations."]},{"l":"Inputs","p":["None for standard use. (All paths and options are handled interactively and by platform detection.)"]},{"l":"Variables","p":["$directoryPath: Output directory for CSV files","$targetFolder: Archive directory for old CSVs","$filePathQuarantine, $filePathTABL: Output file paths","$moduleNames: Required modules"]},{"l":"Command Line Flags","p":["None for standard use."]},{"l":"Outputs","p":["quarantine.csv: Quarantine message records","tabl.csv: Tenant Allow/Block List data","Archived previous CSVs with date-stamped names","Console and error output for user feedback"]},{"l":"Notes","p":["Requires PowerShell 7 and Exchange Online Management module","Script is cross-platform and handles all file paths automatically","See script header for links to official documentation and further details"]}],[{"l":"Exchange-QuarantineTABL-DataDownload.ps1"},{"l":"Purpose","p":["Describe the purpose of this script: e.g., Downloads quarantine data from Exchange Online for analysis."]},{"l":"Function","p":["Explain what the script does and its main logic."]},{"l":"Usage"},{"l":"Inputs","p":["-OutputPath(string): Path to save the downloaded data."]},{"l":"Variables","p":["List and describe any key variables used in the script."]},{"l":"Command Line Flags","p":["-OutputPath: Specifies where to save the data."]},{"l":"Outputs","p":["Downloads quarantine data to the specified file."]},{"l":"Notes","p":["Add any additional notes, requirements, or dependencies."]}],[{"l":"NewTransportRuleExecName.ps1","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Creates or updates a specific Exchange Online transport rule to prepend a disclaimer for messages sent from outside the organisation by someone with a display name matching a user in your organisation. Designed to help prevent impersonation attacks."]},{"l":"Dependencies","p":["Exchange Online Management module( Microsoft Docs)"]},{"l":"Function","p":["Connects to Exchange Online using Connect-ExchangeOnline.","Searches for an existing transport rule by name.","If the rule does not exist, creates it with a specific HTML disclaimer and pattern matching.","If the rule exists, updates it with the latest disclaimer and settings.","Uses hardcoded display name(s) for pattern matching (can be extended for dynamic mailbox display names).","Provides console feedback for each step."]},{"l":"Usage","p":["The script is interactive and does not require command-line parameters for standard use. Rule name and disclaimer are set within the script."]},{"l":"Inputs","p":["None for standard use. (Rule name, disclaimer, and display names are set in the script.)"]},{"l":"Variables","p":["$ruleName: Name of the transport rule","$ruleHtml: HTML disclaimer to prepend","$displayNames: Display names to match for impersonation protection"]},{"l":"Command Line Flags","p":["None for standard use."]},{"l":"Outputs","p":["Creates or updates the specified transport rule in Exchange Online","Provides console feedback for each step"]},{"l":"Notes","p":["Requires the Exchange Online Management module","Script can be extended to dynamically gather display names from all active mailboxes"]}],[{"l":"AutomateCompromisedAccountRemediation.ps1","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Automates Microsoft 365/Entra ID (Azure AD) compromised account remediation using 8 best-practice steps. Handles module installation, logs all actions, and supports both interactive and bulk operation."]},{"l":"Dependencies","p":["PowerShell 7.0 or later( Install Guide)","Microsoft Graph module( Microsoft Docs)","Exchange Online Management module( Microsoft Docs)","Require-Pwsh7.ps1(local script, must be accessible and dot-sourced)"]},{"l":"Function","p":["Loads and validates required modules (installs if missing, with user confirmation).","Connects to Microsoft Graph and Exchange Online (supports certificate-based auth).","Accepts user(s) via parameter, CSV, or interactive prompt.","Presents a menu of 8 remediation actions (disable user, sign out, reset password, review MFA, disable inbox rules, review/remove forwarding, get audit log) or \"all\".","Performs selected actions for each user, logging results and errors to output files.","Exports status, password, invalid user, and error logs to the script directory.","Offers to open the output file at completion."]},{"l":"Usage","p":["The script is interactive and supports both single and bulk operation. User(s) can be provided via parameter, CSV, or prompt."]},{"l":"Inputs","p":["UserPrincipalName(s) via parameter, CSV file, or interactive prompt","Optional: TenantId, ClientId, CertificateThumbprint for CBA"]},{"l":"Variables","p":["$UPNs: Array of user principal names to remediate","$Actions: Array of selected remediation actions","$ExportCSV, $PasswordLogFile, $InvalidUserLogFile, $ErrorsLogFile: Output file paths"]},{"l":"Command Line Flags","p":["None for standard use. (Parameters are supported for automation.)"]},{"l":"Outputs","p":["CSV and TXT logs of all actions, passwords, invalid users, and errors","Console and pop-up feedback for each step"]},{"l":"Notes","p":["Requires PowerShell 7, Microsoft Graph, and Exchange Online Management modules","Local script Require-Pwsh7.ps1 must be accessible","See script header for official documentation links and further details"]}],[{"l":"Entra-UserExternal-Create.ps1","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Automates the creation of external (guest) users in Entra ID (Azure AD), supporting both single and bulk user creation. Handles sponsor resolution, expiry dates, and provides a summary for Service Desk tickets."]},{"l":"Dependencies","p":["PowerShell 7.0 or later( Install Guide)","Microsoft Graph module( Microsoft Docs)","Require-Pwsh7.ps1(local script, must be accessible and dot-sourced)"]},{"l":"Function","p":["Loads and validates required modules (installs if missing).","Connects to Microsoft Graph with required permissions.","Prompts for single or bulk user creation (CSV import).","For each user:","Resolves sponsor by display name (with interactive selection if ambiguous).","Gathers/validates expiry date (defaults to 90 days if blank).","Sends invite and sets user properties (job title, company, expiry, manager, etc.).","Updates CSV and provides progress feedback in bulk mode.","Provides a summary of actions for Service Desk ticketing and copies it to clipboard."]},{"l":"Usage","p":["The script is interactive and supports both single and bulk user creation. All required information is prompted or read from CSV."]},{"l":"Inputs","p":["Interactive prompts for user details (single mode)","CSV file for bulk user creation (fields: firstName, lastName, jobTitle, companyName, emailAddress, invitePurpose, sponsor, expiryDate)"]},{"l":"Variables","p":["$moduleNames: Required modules","$csvPath: Path to CSV for bulk mode","$sponsor: Sponsor user object","$expiryDate: Expiry date for external user"]},{"l":"Command Line Flags","p":["None for standard use."]},{"l":"Outputs","p":["Creates external users and sends invites","Sets user properties (job title, company, expiry, manager, etc.)","Updates CSV with status in bulk mode","Copies summary to clipboard and displays for Service Desk ticketing"]},{"l":"Notes","p":["Requires PowerShell 7, Microsoft Graph module, and local Require-Pwsh7.ps1 script","Script provides clear error messages and instructions for each step"]}],[{"l":"User-Management-External.ps1","p":["Management of guest accounts within Entra is, IMHO, a pain in the behind.","If your guest accounts are fully cloud, and you're not a big organisations who can make its ITSM do the heavy lifting for you - Entra lacks:","fields for recording when accounts should expire,","native method of automatically following up with the sponsor if the account is still needed, and","a method that disables the account when they expire.","This script seeks to close these gaps.","Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Audits and manages external (guest) users in Entra ID (Azure AD). Gathers details on all active guest accounts, their sponsors, and writes results to CSV for further action or reporting."]},{"l":"Dependencies","p":["Microsoft Graph module( Microsoft Docs)"]},{"l":"Function","p":["Connects to Microsoft Graph with required permissions.","Retrieves all enabled guest users and their key properties (display name, UPN, company, created date, etc.).","For each guest, retrieves sponsor details and compiles a full report.","(Planned) Checks for accounts within 14, 7 and 1 day(s) of expiry, notifies sponsors to take action, and disables expired accounts. Note: If a sponser contacts the service desk to extend the accountm, then you should go into the Guest record and update the field being used for expiry date.","Exports results to a dated CSV file for audit and reporting.","Disconnects from Microsoft Graph at completion."]},{"l":"Usage","p":["The script is interactive and does not require command-line parameters for standard use. All actions are performed in sequence."]},{"l":"Inputs","p":["None for standard use. (All required information is gathered interactively or from Entra ID.)"]},{"l":"Variables","p":["$guestUsers: List of enabled guest users","$results: Array of audit results for export","$sponsors: Sponsor user objects"]},{"l":"Command Line Flags","p":["None for standard use."]},{"l":"Outputs","p":["Exports a CSV report of all active guest users and their sponsors","Provides console feedback for each step"]},{"l":"Notes","p":["Requires the Microsoft Graph module","Script can be extended to automate notifications and account disabling as described in the comments"]}],[{"l":"Module-PowerShell7-Require.ps1"},{"l":"Table of Contents","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Ensures the script is running in PowerShell 7 (pwsh). If not, attempts to relaunch itself in PowerShell 7, or offers to install it or open the official install page. This is a robust enforcement and user guidance utility for cross-platform and modern PowerShell script compatibility."]},{"l":"Dependencies","p":["PowerShell 7 (pwsh)","Invoke-WebRequest","Start-Process"]},{"l":"Function","p":["Checks if the script is running in PowerShell 7 (Core, version 7+).","If already running in PowerShell 7, continues execution.","If not, attempts to relaunch itself in PowerShell 7 using pwsh.","If pwsh is not found, prompts the user to:","Install PowerShell 7.4.1 automatically (silent install, requires admin)","Open the official install website","Do nothing and exit","Handles download and silent install of PowerShell 7.4.1 if chosen and running as admin.","Provides clear, accessible output and error handling for all scenarios."]},{"l":"Usage","p":["Note: Dot-sourcing loads the function into your session so it can be called. Adjust the path as needed for your environment."]},{"l":"Inputs","p":["-ScriptToRelaunch(string, optional): Path to the script to relaunch in PowerShell 7. Defaults to the current script."]},{"l":"Variables","p":["$ScriptToRelaunch: Script path to relaunch if not in PowerShell 7.","$PSVersionTable: Used to check current PowerShell version and edition.","$installerPath: Temporary path for the PowerShell 7 MSI installer.","$downloadUrl: URL for the PowerShell 7.4.1 MSI download.","$choice: User's menu selection for install/open/exit."]},{"l":"Command Line Flags","p":["-ScriptToRelaunch: Specifies the script to relaunch in PowerShell 7 (optional)."]},{"l":"Outputs","p":["Relaunches the script in PowerShell 7 if needed.","Installs PowerShell 7.4.1 if chosen and running as admin.","Opens the official install page if chosen.","Exits with a message if PowerShell 7 is not available and not installed.","Provides clear user feedback and error messages for all actions."]},{"l":"Notes","p":["This function is intended to be dot-sourced or included at the top of scripts that require PowerShell 7.","Handles both interactive and automated scenarios robustly.","Requires internet access for automatic install.","All output is accessible and uses EN-AU spelling.","See project standards for robust root-based module import and error handling."]}],[{"l":"Update-Module.ps1"},{"l":"Table of Contents","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Updates all installed PowerShell modules from the PowerShell Gallery to their latest available versions, with options to exclude modules, skip major version updates, and remove old versions. Designed for robust, unattended module maintenance."]},{"l":"Dependencies","p":["PowerShellGet","Get-InstalledModule","Find-Module","Update-Module","Uninstall-Module"]},{"l":"Function","p":["Finds all installed modules from the PowerShell Gallery, excluding any specified in -ExcludedModules.","For each module, checks if a newer version is available in PSGallery.","If a newer version exists:","Optionally skips major version updates if -SkipMajorVersion is set.","Updates the module to the latest version.","Removes old versions unless -KeepOldModuleVersions is set or the module is in -ExcludedModulesforRemoval(default: Az).","Handles errors and logs progress for each module.","Provides verbose output and supports -WhatIf/-Confirm via SupportsShouldProcess."]},{"l":"Usage","p":["Run directly to update all modules:","Or, from within another script (dot-source if you want to call the function directly):"]},{"l":"Inputs","p":["-ExcludedModules(array, optional): Modules to exclude from updating.","-SkipMajorVersion(switch, optional): Skip major version updates to avoid breaking changes.","-KeepOldModuleVersions(switch, optional): Keep old versions of modules after updating.","-ExcludedModulesforRemoval(array, optional): Modules to exclude from removal of old versions (default: Az)."]},{"l":"Variables","p":["$CurrentModules: List of installed modules to check for updates.","$GalleryModule: Latest version info from PSGallery for each module.","$ExcludedModules, $SkipMajorVersion, $KeepOldModuleVersions, $ExcludedModulesforRemoval: Parameters controlling update/removal logic."]},{"l":"Command Line Flags","p":["-Verbose: Shows detailed progress and actions.","-WhatIf/-Confirm: Supported for safe execution/testing.","All function parameters above can be used as flags if calling Update-EveryModule directly."]},{"l":"Outputs","p":["Updates modules to the latest version from PSGallery.","Removes old versions unless excluded or instructed to keep.","Logs progress, warnings, and errors to the console."]},{"l":"Notes","p":["The script runs Update-EveryModule -Verbose by default when executed.","Designed for PowerShell 7+ and robust unattended use.","Excludes the Az module from removal by default for stability.","All output is accessible and uses EN-AU spelling.","See project standards for robust root-based module import and error handling."]}],[{"l":"Password-Generator-Silent.ps1"},{"l":"Table of Contents","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Generates a strong password silently for use in automation or scripts, using random words, numbers, and symbols for complexity."]},{"l":"Dependencies","p":["Four CSV files containing word lists: 4letter.csv, 5letter.csv, 6letter.csv, 7letter.csv(each with a Word column)","Import-Csv","Get-Random"]},{"l":"Function","p":["Loads word lists from four CSV files (4, 5, 6, and 7 letter words).","Randomly selects either a 4+7 or 5+6 letter word combination.","Capitalises the first letter of each word and concatenates them.","Appends two random numbers (0-9 each, as a string).","Adds a random symbol from a predefined set, placed before or after the numbers at random.","Returns the generated password as a string.","If any CSV is missing or empty, outputs an error message and returns nothing."]},{"l":"Usage","p":["Run directly to output a password:"]},{"l":"Inputs","p":["None (all configuration is internal; ensure the required CSV files exist at the specified paths)."]},{"l":"Variables","p":["$4letter, $5letter, $6letter, $7letter: Paths to the CSV word lists.","$list4, $list5, $list6, $list7: Arrays of words loaded from the CSVs.","$randomCombination: Determines which word length combination to use.","$word1, $word2: The randomly selected words.","$randomNumber1, $randomNumber2: Random digits for the password.","$symbols: String of allowed symbols.","$randomSymbol: The randomly selected symbol.","$symbolPlacement: Determines symbol position in the password.","$password: The final generated password."]},{"l":"Command Line Flags","p":["None."]},{"l":"Outputs","p":["Outputs a generated password as a string (to the pipeline or variable).","If a required CSV is missing or empty, outputs an error message and returns nothing."]},{"l":"Notes","p":["CSV file paths are hardcoded; update them as needed for your environment.","All output is accessible and uses EN-AU spelling.","See project standards for robust root-based module import and error handling."]}],[{"l":"Password-Generator.ps1"},{"l":"Table of Contents","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Interactively generates a secure 14-character password using a Windows Forms GUI, with capitals, symbols, and numbers in an easy-to-read format. Allows users to generate and copy passwords interactively."]},{"l":"Dependencies","p":["System.Windows.Forms","System.Drawing","Import-Csv","Get-Random","Set-Clipboard","Four CSV files containing word lists: 4letter.csv, 5letter.csv, 6letter.csv, 7letter.csv(each with a Word column)"]},{"l":"Function","p":["Displays a Windows Forms GUI with a description, generate button, password display box, and copy button.","Loads word lists from four CSV files (4, 5, 6, and 7 letter words).","When the user clicks \"Generate\":","Randomly selects either a 4+7 or 5+6 letter word combination.","Capitalises the first letter of each word and concatenates them.","Appends two random numbers (10-99 each, as a string).","Adds a random symbol from a predefined set, placed before or after the numbers at random.","Displays the generated password in the textbox.","When the user clicks \"Copy\":","Copies the password to the clipboard.","Shows a pop-up message confirming the copy.","If any CSV is missing or empty, outputs an error and exits."]},{"l":"Usage","p":["Run directly to launch the GUI:"]},{"l":"Inputs","p":["User interaction via the GUI (button clicks). No command-line parameters."]},{"l":"Variables","p":["$form, $descriptionLabel, $button, $passwordBox, $copyButton: Windows Forms controls.","$4letter, $5letter, $6letter, $7letter: Paths to the CSV word lists.","$list4, $list5, $list6, $list7: Arrays of words loaded from the CSVs.","$randomCombination, $word1, $word2, $combinedWords: Used for password construction.","$randomNumber1, $randomNumber2, $randomNumbers: Random numbers for the password.","$symbols, $randomSymbol, $symbolPlacement, $password: Used for symbol and final password logic."]},{"l":"Command Line Flags","p":["None."]},{"l":"Outputs","p":["Displays the generated password in the GUI textbox.","Copies the password to the clipboard when requested.","Shows a pop-up message on successful copy.","If a required CSV is missing or empty, outputs an error and exits."]},{"l":"Notes","p":["CSV file paths are hardcoded; update them as needed for your environment.","Requires Windows and PowerShell 7+ for GUI and clipboard support.","All output is accessible and uses EN-AU spelling.","See project standards for robust root-based module import and error handling."]}],[{"l":"ScriptSelector.ps1"},{"l":"Table of Contents","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Provides an interactive Windows Forms menu to select and launch common PowerShell scripts, with user-friendly feedback and error handling.","Needs a future enhancement to be able to specify if a script should run in PowerShell 7, and if so - launch the script in it."]},{"l":"Dependencies","p":["System.Windows.Forms","System.Drawing","Start-Process","Join-Path","Test-Path"]},{"l":"Function","p":["Displays a Windows Forms GUI with a numbered list of available scripts (from a configurable array).","Allows the user to select a script and click \"Run\" to execute it.","Launches the selected script in a new PowerShell process, waits for completion, and checks the exit code.","Future enhancement: Allow a script to be launched directly in PowerShell 7 if needed.","Provides user feedback via pop-up messages for success, error, or cancellation.","Handles missing script files and displays an error if not found.","Automatically numbers menu items based on their order in the array."]},{"l":"Usage","p":["Run directly to launch the menu:"]},{"l":"Inputs","p":["User selection via the GUI menu (list box and button click)."]},{"l":"Variables","p":["$form, $listBox, $runButton: Windows Forms controls for the menu and actions.","$scriptBasePath: Base directory for script files.","$scriptInfo: Array of script display names and file names.","$scriptMapping: Array of numbered menu items and corresponding file names.","$selectedScript, $scriptItem, $scriptFile, $scriptPath: Used for script selection and execution."]},{"l":"Command Line Flags","p":["None."]},{"l":"Outputs","p":["Launches the selected script in a new PowerShell process.","Shows pop-up messages for script completion, error, or cancellation.","Displays an error if the script file is not found."]},{"l":"Notes","p":["Script paths and menu items are configurable in the $scriptInfo array.","Requires Windows and PowerShell 7+ for GUI support.","All output is accessible and uses EN-AU spelling.","See project standards for robust root-based module import and error handling."]}],[{"l":"Intune-BulkSync.ps1","p":["Forcing Intune sync for devices is a nightmare. The pages and blades make selecting devices a pain in the behind.","So I write a command line UI to speed up that process significantly."]},{"l":"Table of Contents","p":["Purpose","Dependencies","Function","Usage","Inputs","Variables","Command Line Flags","Outputs","Notes"]},{"l":"Purpose","p":["Performs bulk, OS-specific, group-based, or single device synchronisation of devices in Microsoft Intune, using an interactive menu. Handles module checks, authentication, and robust user feedback."]},{"l":"Dependencies","p":["PowerShell 7","[Require-Pwsh7.ps1] (custom module, dot-sourced)","Microsoft.Graph.Intune","Microsoft.Graph.DeviceManagement","Microsoft.Graph.Authentication","Connect-MgGraph"]},{"l":"Function","p":["Imports and enforces PowerShell 7 usage via a custom module.","Checks for and installs required Microsoft Graph modules if missing.","Authenticates the user to Microsoft Graph with required permissions.","Presents an interactive menu to:","Sync all Windows, Android, or iOS devices","Sync all devices (all OS)","Sync a single device by name (with partial match and selection)","Sync all devices in defined test groups","End the script","For each sync, retrieves devices and initiates a sync via Microsoft Graph.","Provides user feedback, error handling, and confirmation dialogs throughout.","Handles script exit and cleanup gracefully."]},{"l":"Usage","p":["Note: Ensure PS7 is being used to run the script, otherwise you will need the custom module to ensure the script is launched in PS7.","Run directly to launch the menu:","Follow the prompts to select the sync type and target devices."]},{"l":"Inputs","p":["User selection via interactive menu (no command-line parameters).","Prompts for device name (for single device sync) and menu choices."]},{"l":"Variables","p":["$modulePath: Path to the required PowerShell 7 enforcement module.","$moduleNames: Array of required Microsoft Graph modules.","$devices, $device, $partialMatches, $deviceIds, $groups, $members: Used for device and group management.","$choice, $repeat: User menu selections."]},{"l":"Command Line Flags","p":["None (all interaction is via menu and prompts)."]},{"l":"Outputs","p":["Initiates device syncs in Intune and logs results to the console.","Provides pop-up and console feedback for success, errors, and completion.","Exits gracefully with user confirmation."]},{"l":"Notes","p":["Requires PowerShell 7 and Microsoft Graph modules.","Custom module Require-Pwsh7.ps1 must be present and accessible.","All output is accessible and uses EN-AU spelling.","See project standards for robust root-based module import and error handling."]}],[{"l":"Win-Storage Intune Detection and Remediation","p":["Provides detection and remediation scripts, for performing deep disk space cleanup on Windows devices.","This landing page provides a concise entry point and links to focused pages for configuration, logic, deployment and troubleshooting.","See the sub-pages in this folder for full details:","Detection","Detection script","Remediation","Remediation logic","Remediation script","Example logs (full samples)","Intune setup & deployment","Function reference","Troubleshooting & logging","References","Changelog"]},{"l":"On this page","p":["Quick start","Before you begin","Credits"]},{"l":"Quick start","p":["For developer and operator guidance, use the links above. This file is intentionally short to make the site navigation easy to use."]},{"l":"Before you begin","p":["Use as one part of an overall device disk space management strategy","This script is just one of the tools needed in your toolbox for keeping disk usage on your Windows Intune devices under control.","There is no single method available within Intune to achieve this outcome and remove all system and other on your devices.","Whilst this script incorporates the efforts of the following remediations, always make your own evaluations and determinations on the best approach for keeping end user device disk space utilisation your tenant under control:","Automatically Delete Old User Profiles using Intune - Prajwal Desai","How to Configure Storage Sense using Intune - Prajwal Desai","This script as designed will archive the contents of all log files specified in $logsToClear","Please ensure you are aware of the implications and impacts of this, and ensure log file selection is performed accordingly.","If using this approach in a Corporate or Enterprise environment - always ensure your relevant Information Security professionals are included as part of a proper ITIL or other appropriate Change Management approach, for choosing what logs to archive and clear on the computers being targeted by this script, and understanding/managing any consequences this may have to your Security Monitoring approach and posture."]},{"l":"Credits","p":["Use Endpoint Analytics to clean up the disk - Jannik Reinhard"]}],[{"l":"Detection script details","p":["This page contains the detection script behaviour and inputs/outputs for Win-Storage-Detect.ps1.","View Detection Script on GitHub","Logic","Inputs","Outputs"]},{"l":"Logic","p":["Obtains the hostname.","Evaluates the last character of the hostname against the current day to determine if the script should run today (this step can be removed or customised as needed).","Evaluates available storage space."]},{"l":"Inputs","p":["$storageThreshold: The minimum free storage threshold in GB. Default is 40."]},{"l":"Outputs","p":["Exit codes:","0: Compliant (Available storage exceeds the threshold).","1: Not compliant (Available storage is below the threshold)."]}],[{"l":"Remediation logic","p":["This page describes the overall remediation logic and the primary remediation actions executed by the script.","This list is intended as a quick reference. Each function includes an inline comment block in the script describing behaviour, safety considerations and edge cases. When writing tests or adapting the script, prefer calling these helpers rather than re-implementing enumerators or retry logic.","Overview","Remediation Script Logic","CleanMgr Cleanup","Storage Sense Cleanup","DISM Component Store Cleanup","User-Specific Temporary File Cleanup","Event Log Cleanup","Old User Profile Cleanup","Logging","Disk Space Accounting","Notes for testers and automation"]},{"l":"Overview","p":["This page covers the remediation flow used by Win-Storage-Remediate.ps1. Each major action is described with safety notes and references to helper functions."]},{"l":"Remediation Script Logic","p":["The remediation script performs the following actions. Each major action below is given a short subsection heading to provide stable anchors for the documentation and Intune parameter links."]},{"l":"CleanMgr Cleanup","p":["Prepares selected CleanMgr VolumeCaches by setting StateFlags0001 in the registry.","Suppresses the Disk Cleanup GUI to ensure silent execution.","Validates the cleanmgr.exe path before execution.","Logs the process exit code."]},{"l":"Storage Sense Cleanup","p":["Configures and triggers Storage Sense to remove temporary files and locally cached OneDrive content.","Uses Set-StorageSense and Start-StorageSense cmdlets where available."]},{"l":"DISM Component Store Cleanup","p":["Runs DISM with /Online /Cleanup-Image /StartComponentCleanup to clean up the WinSxS component store.","Logs the process exit code and respects pending-reboot detection."]},{"l":"User-Specific Temporary File Cleanup","p":["Removes files from %USERPROFILE%\\\\AppData\\\\Local\\\\Temp, leaving folders expressly excluded by the script.","Implements retry logic for file access conflicts and respects $MaxCleanupDurationMinutes time budgets."]},{"l":"Event Log Cleanup","p":["Exports selected logs to an archive directory ($env:TEMP\\\\EventLogArchives) using wevtutil epl.","Clears selected logs using wevtutil cl after successful export."]},{"l":"Old User Profile Cleanup","p":["Removes user profiles under C:\\Users that are not whitelisted ( Default, Default User, Public, All Users) and have not been used in the last $userProfileRetentionDays days."]},{"l":"Logging","p":["Centralised logging with Start-Transcript and Write-Log.","Temporary logs are consolidated into the main log file at the end of the script; archives are created per-run."]},{"l":"Disk Space Accounting","p":["Captures initial free space on C: before remediation.","Captures final free space after remediation and calculates the recovered space."]},{"l":"Notes for testers and automation","p":["Prefer -DryRun for initial tests.","Use -CleanMgrOnly to test CleanMgr preparation without further changes.","Use -SKIP_SLOW_IO on slow VMs to avoid long enumeration passes."]}],[{"l":"Remediation script details","p":["This page summarises the remediation actions performed by Win-Storage-Remediate.ps1, the inputs, outputs and exit codes.","View Remediation Script on GitHub","Base Configuration Parameters","Configuration","Defining What to Remove with $cleanupTypeSelection","Defining what Logs to Clear with $logsToClear","skipPathPatterns — what they are and why they matter (region 0C)","Functions (region 0D) — summary and purpose","Logic","Inputs","Outputs"]},{"l":"Base Configuration Parameters"},{"l":"Configuration","p":["(array)","(boolean)","(paths)","(string)","$cleanupTypeSelection","$logFile/ $tempLogFile/ $archiveDirectory/ $archiveFile","$logsToClear","$MaxCleanupDurationMinutes","$oneDriveCleanupThreshold","$scriptName","$tempLogAgeDays","$tempLogSizeThresholdMB","$transcriptStarted","$userProfileRetentionDays","20","30","5(or 50 depending on runtime initialisation)","7","Base name used for log files and archives (for example Remediate-DiskCleanup-Extended or Win-Storage-Remediate). See Remediation Script Configuration.","CleanMgr VolumeCache categories configured for cleanmgr.exe registry preparation (the script sets StateFlags0001 so cleanmgr /sagerun:1 will include them). See Defining What to Remove with $cleanupTypeSelection.","Contained within region 0C of the remediation script, these exposes a small set of configuration variables, which are explained below.","Default","Description","If the existing temp log exceeds this size (MB) the script archives it at startup to avoid unbounded temp logs. See Logging, troubleshooting and support.","If the existing temp log is older than this many days, it is archived at startup. See Logging, troubleshooting and support.","Internal flag tracking whether Start-Transcript was started successfully so Stop-Transcript can be called safely. See Logging, troubleshooting and support for transcript handling.","List of event log channel names the script will attempt to export and clear using wevtutil. See Defining what Logs to Clear with $logsToClear.","Number of days of inactivity after which a local user profile under C:\\Users may be considered for removal (whitelisted accounts such as Default, Public remain excluded). See Remediation Script Logic.","Number of days used by Storage Sense and the probe logic to decide when locally cached OneDrive content is a candidate for cleanup. See Remediation Script Logic for details.","Parameter","Paths used for centralised logging and archival. $tempLogFile is a temporary per-run log consolidated into $logFile at the end of the run. $archiveDirectory/$archiveFile are used for per-run archives and fallback archival behaviour. See Logging, troubleshooting and support.","Soft time budget (minutes) used by recursive enumeration/cleanup loops (for example user-temp and global-temp passes). Enumerators check elapsed time and stop when the budget is exceeded. See Remediation Script Logic.","These configuration variables are declared near the top of the script and are deliberately conservative by default. When deploying via Intune, prefer wrapping the script in a small launcher that sets organisation-specific values instead of editing the script inline."]},{"l":"Defining What to Remove with $cleanupTypeSelection","p":["Active Setup Temp Folders","Archived error reports.","BranchCache","Browser cache files.","By modifying the contents of the $cleanupTypeSelection variable, you can customise the items to be removed during the remediation. The following is a list of values that can be added to this variable:","Cached content for BranchCache.","Category","Content Indexer Cleaner","Content indexing data.","Description","Device Driver Packages","Downloaded Program Files","Files created by chkdsk.","Files discarded during upgrades.","Files downloaded by Internet Explorer.","Files from previous Windows installations.","Files from service pack cleanup.","Files from Windows Update cleanup.","Files in the Recycle Bin.","Game news files.","Game statistics files.","Game update files.","GameNewsFiles","GameStatisticsFiles","GameUpdateFiles","Internet Cache Files","Logs from Windows upgrades.","Memory Dump Files","Offline Pages Files","Offline web pages.","Old ChkDsk Files","Old driver packages.","Old versions of user files.","Previous Installations","Queued error reports.","Recycle Bin","Service Pack Cleanup","Setup Log Files","Setup log files.","System archived error reports.","System error memory dump files","System error memory dump files.","System error minidump files","System error minidump files.","System memory dump files.","System queued error reports.","Temporary Files","Temporary files.","Temporary folders for Active Setup.","Temporary Setup Files","Temporary setup files.","Temporary Sync Files","Temporary sync files.","Thumbnail Cache","Thumbnail cache files.","Update Cleanup","Upgrade Discarded Files","User file versions","Windows Defender","Windows Defender logs and data.","Windows Error Reporting Archive Files","Windows Error Reporting Queue Files","Windows Error Reporting System Archive Files","Windows Error Reporting System Queue Files","Windows ESD installation files","Windows installation files.","Windows Upgrade Log Files"]},{"l":"Defining what Logs to Clear with $logsToClear","p":["Application","Application Inventory Logs","Application inventory logs.","Application Logs","Application Telemetry Logs","Application telemetry logs.","Description","Event Log Service Logs","Event log service logs.","Forwarded Events","Group Policy Logs","Group Policy logs.","Hardware Events","Hardware-related events.","HardwareEvents","Log Type","Logs forwarded from other systems.","Logs related to system setup.","Microsoft-Windows-Application-Experience/Program-Inventory","Microsoft-Windows-Application-Experience/Program-Telemetry","Microsoft-Windows-Diagnostics-Performance/Operational","Microsoft-Windows-Eventlog/Operational","Microsoft-Windows-GroupPolicy/Operational","Microsoft-Windows-NetworkProfile/Operational","Microsoft-Windows-NetworkProvider/Operational","Microsoft-Windows-PowerShell/Operational","Microsoft-Windows-TaskScheduler/Operational","Microsoft-Windows-TerminalServices-LocalSessionManager/Operational","Microsoft-Windows-TerminalServices-RemoteConnectionManager/Operational","Microsoft-Windows-User Profile Service/Operational","Microsoft-Windows-Windows Defender/Operational","Microsoft-Windows-WindowsUpdateClient/Operational","More information on this log type","Network Profile Logs","Network profile logs.","Network Provider Logs","Network provider logs.","Performance Diagnostics Logs","Performance diagnostics logs.","PowerShell Logs","PowerShell operational logs.","Remote Desktop connection logs.","Remote Desktop Logs","Remote Desktop Services logs.","Security","Security Logs","Security-related logs.","Setup","Setup Logs","Standard application logs.","Standard system logs.","System","System Logs","Task Scheduler Logs","Task Scheduler logs.","The $logsToClear variable defines the event logs to process during remediation. The following logs are included by default:","User Profile Logs","User profile service logs.","Windows Defender Logs","Windows Defender logs.","Windows Update Logs","Windows Update logs."]},{"l":"skipPathPatterns — what they are and why they matter (region 0C)","p":["$skipPathPatterns is an array of regular-expression strings used by Test-IsSkipPath and the pruned enumerator Get-SafeChildItems to avoid touching files and folders that are:","OneDrive / Files On-Demand and synchronisation engine files (databases, caches, sidecars, .odl, .odlgz, .aodl). Removing these can lead to user data loss or client corruption.","Database files and lock files (.db, .sqlite, .ldb, .db-wal, .db-shm) which are often in use and should not be deleted by a passive cleanup.","Core OS and application folders (e.g. Windows, WinSxS, Program Files, ProgramData) and special system files (pagefile.sys, hiberfil.sys, swapfile.sys). These are explicitly protected.","Event log and trace files (.evtx, .etl) and Windows Error Reporting items.","Crypto and machine key locations which must never be removed.","Key behaviour notes:","Patterns are treated as regular expressions where possible (the script attempts regex matching first and falls back to conservative containment checks when a pattern cannot be parsed as regex).","The list purposely errs on the side of safety — even if a pattern is broad it is used to prune recursion or skip an item rather than attempt deep deletion. The script treats matches as “do not touch”.","Common OneDrive tokens are included, plus explicit file-extension guards for .odl, .odlgz and .aodl which are treated as OneDrive sidecar files.","You may tune the $skipPathPatterns for your environment, but do so carefully. Any change that weakens these patterns increases the likelihood of deleting important or in-use files."]},{"l":"Functions (region 0D) — summary and purpose","p":["See Functions"]},{"l":"Logic","p":["See Logic"]},{"l":"Inputs","p":["See Remediation Script Configuration for full information."]},{"l":"Outputs","p":["Logs of actions taken and results saved to $env:TEMP\\scriptName.log.","Disk space recovered, logged as the difference between initial and final free space on the C: drive.","Additional outputs and behavioural notes:","Exit codes:","0= Success (normal completion)","1= General failure (useful for remote monitoring). Individual step failures are logged but do not always change the exit code unless a fatal condition is detected.","Transcripts: the script uses Start-Transcript where available to capture console output. A temporary transcript is consolidated into the main log at the end of the run (or archived if locked).","Archival behaviour: the script prefers an atomic Move-Item of the main log into a per-run archive file. If that fails it falls back to append+truncate into a single fallback archive file. If both approaches fail a diagnostic .diag.txt file is written into the archive directory containing the failure details.","Retry/backoff and time budgets: removal operations are implemented with per-item retry/backoff and limited by $MaxCleanupDurationMinutes in long enumerations so the script does not get stuck on a single locked/slow subtree.","Dry-run semantics: when -DryRun is used the script will log intended actions (for example which files would be removed or archived) but not perform destructive actions like Remove-Item or Move-Item."]}],[{"l":"Example logs (full samples)"}],[{"l":"Intune setup & deployment","p":["This section describes recommended steps and settings for deploying the detection and remediation scripts through Microsoft Intune (Endpoint Manager) using Proactive Remediations or the Device Management Scripts workflow.","These recommendations are conservative. Always test in a small pilot group or on disposable VMs before broad rollout.","How to deploy","Recommended deployment method","Proactive Remediations configuration (suggested)","If you do not use Proactive Remediations","Script parameterisation and configuration","Things to consider","Recommended runtime safety and behaviour settings","Prerequisites and environment considerations","Recommended rollout plan","Logging, troubleshooting and support","Common issues and mitigations","Security and information governance","Helpful Intune documentation links"]},{"l":"How to deploy"},{"l":"Recommended deployment method","p":["Use Intune > Devices > Manage Devices > Scripts and remediations> Create script package to deploy these scripts as a detection/remediation pair."]},{"l":"Proactive Remediations configuration (suggested)","p":["Run detection script: Daily (or more/less often depending on your tolerance for disk-space issues).","Run remediation: Allow remediation when detection fails. Proactive Remediations will run the remediation script automatically when the detection script reports non-compliance.","Detection script file: Win-Storage-Detect.ps1(returns exit code 0 = compliant, 1 = non-compliant)","Remediation script file : Win-Storage-Remediate.ps1","Run as: System (do not run as user). The remediation requires administrative privileges for CleanMgr, DISM, event-log export, and deleting system-level files.","Enforce script signature check: No","Architecture: 64-bit (do not select \"Run script in 32-bit PowerShell\" for 64-bit clients)."]},{"l":"If you do not use Proactive Remediations","p":["You may upload the remediation script as a normal Device Management script. In that case schedule the detection script as a separate compliance check and only run the remediation script on devices that have been flagged by the detection run."]},{"l":"Script parameterisation and configuration","p":["Intune's script upload UI does not provide a built-in way to pass named PowerShell parameters at execution time. To change behaviour, either:","Edit the configuration variables near the top of Win-Storage-Remediate.ps1(for $oneDriveCleanupThreshold, $userProfileRetentionDays, $cleanupTypeSelection, $logsToClear, $MaxCleanupDurationMinutes, etc.) before upload; or","Wrap the uploaded script in a tiny launcher that sets variables and then dot-sources the main script (advanced)."]},{"l":"Things to consider"},{"l":"Recommended runtime safety and behaviour settings","p":["Always test with -DryRun locally to view the actions the script would take without applying destructive changes.","Use -SKIP_SLOW_IO in test environments where long I/O should be avoided (e.g., VMs with slow storage). In production, leave it off unless you have reason to avoid disk-bound operations.","The script attempts to be conservative about OneDrive and database files by matching configured $skipPathPatterns. Review and tune that list for your tenant if custom paths need to be excluded or included."]},{"l":"Prerequisites and environment considerations","p":["The remediation script must run elevated (System or Administrator). Intune Proactive Remediations running as System is recommended.","The script uses Windows-native tooling such as wevtutil, DISM and cleanmgr.exe. These tools are available on supported Windows client OSes (Windows 10/11). If you target older or custom Windows builds, validate tool availability.","Storage Sense cmdlets are used when present; they are available only on Windows client builds that include the corresponding module/commands. The script checks for cmdlet availability and skips those steps if not present."]},{"l":"Recommended rollout plan","p":["Local validation: run Win-Storage-Remediate.ps1 -DryRun -Verbosity Verbose on a test VM and confirm logs and reported actions.","Small pilot: deploy detection+remediation to a limited set of machines (1–5 devices). Monitor logs and disk outcomes.","Phased rollout: expand to progressively larger rings, monitoring disk impact, archive usage, and support tickets."]},{"l":"Logging, troubleshooting and support","p":["Primary logs: the script writes a consolidated log to %TEMP%\\scriptName.log(typically %TEMP%\\Win-Storage-Remediate.log) and a temp log %TEMP%\\scriptName_temp.log during execution. On failure the script writes archive diagnostics into the %TEMP%\\ArchivedLogs folder.","If a remediation run appears to do nothing, check the detection script output first (detection returns exit codes). Then inspect the device logs under the user's TEMP and System TEMP ( C:\\Windows\\Temp) and the archive folder for diagnostic files.","For troubleshooting, run the remediation script manually with -DryRun -Verbosity Verbose and review the transcript/log file. Also check event viewer for related errors."]},{"l":"Common issues and mitigations","p":["Problem: Intune script times out or is terminated mid-run Mitigation: shorten the work the script does (use -CleanMgrOnly) or adjust your Intune script timeout settings if available; perform large cleanups during maintenance windows; ensure $MaxCleanupDurationMinutes is set reasonably.","Problem: DISM skipped due to pending reboot Explanation: script detects pending reboot and will not run DISM unless -ForceDISMWhenPending is provided. This prevents partial cleanup operations that may be unsafe across reboots.","Problem: Event log exports fail on some logs (permission or file-lock) Mitigation: script logs individual export failures and continues; verify permissions and consider excluding problematic logs from $logsToClear."]},{"l":"Security and information governance","p":["This script archives and clears selected event logs. Ensure you coordinate with security and monitoring teams before broad deployment to avoid unintended loss of telemetry.","Ensure any archived log retention meets your organisation's compliance and retention policy. The script writes archives into %TEMP% by default — you may wish to redirect archive storage to a centralised location via a wrapper or post-processing step if required."]},{"l":"Helpful Intune documentation links","p":["Proactive remediations (Endpoint analytics): https://learn.microsoft.com/mem/analytics/proactive-remediations","Add and assign PowerShell scripts in Intune: https://learn.microsoft.com/mem/intune/apps/intune-management-extension"]}],[{"l":"Function reference","p":["Advanced Delivery Optimization content cleanup for ProgramData locations (safe, non-service-disrupting removals).","Attempts to estimate Recycle Bin size via Shell.Application COM interface (best-effort; may return 0 if unavailable).","Canonical protection check used throughout the script; prevents touching the script's own logs/archives, reparse points, and other system-critical locations.","Cautious Windows Update download folder cleaner (non-rebooting).","Centralised logging helper. Writes timestamped entries to the temporary log and respects the -Verbosity parameter (controls Write-Verbose/ Write-Information behaviour).","Cleans Windows Update download cache ( SoftwareDistribution\\\\Download) using pruned enumeration.","Clear-BrowserCache","Clear-BrowserCacheAllUsers","Clear-DeliveryOptimizationAdvanced","Clear-DeliveryOptimizationCache","Clear-OneDriveUserCache","Clear-SoftwareDistributionDownload","Clear-WindowsUpdateDownloadCache","Creates per-run archives of the main log, preferring atomic Move-Item and falling back to append+truncate or diagnostic files.","Detects common pending-reboot markers (Windows Update, CBS/Component-Based Servicing, PendingFileRenameOperations).","DISM invocation wrapper that honours pending-reboot detection and the -ForceDISMWhenPending flag; logs exit codes and supports a WhatIf/ DryRun fast path.","Enumerates Delivery Optimization cache locations and removes safe content (pruned enumerator and protected-path checks apply).","Export-EventLog","Exposed cleanup pass for the machine/global TEMP folder (%TEMP).","Exposed cleanup pass that removes per-user temp files under %USERPROFILE%\\\\AppData\\\\Local\\\\Temp using the safe enumerator and time budgets.","Format-Size","Function","Generic retry wrapper that executes a provided scriptblock with configurable retries and backoff.","Get-BrowserCachePathsForUser","Get-ProbeSnapshot","Get-RecycleBinSize","Get-SafeChildItems","Helper that returns common browser cache paths for a given user profile (used by Clear-BrowserCacheAllUsers).","High-level routine to clear browser caches across user profiles (safe, pruned, and DryRun-aware).","Invoke-DISM-Safe","Invoke-GlobalTempCleanup","Invoke-RemoveWithRetry","Invoke-UserTempCleanup","Invoke-WithRetry","Lightweight check to determine whether a file is locked by attempting to open it exclusively.","Matches a path against $skipPathPatterns(regex-first, with safe fallbacks). Returns true for paths that must not be removed or traversed.","Merge-Log","Per-user browser cache cleanup for common browsers (Chrome, Edge, Firefox) using pruned enumeration and protected-path guards.","Per-user OneDrive cache cleaner. Avoids user documents and config files; walks directories using a stack-based enumerator to avoid reparse point traversal.","Purpose","Read-only size probe: computes sizes for provided paths (used by -Estimate and diagnostic probes).","Remove-Item wrapper with path canonicalisation, skip/protection checks, retry/backoff and timing/diagnostic messages.","Resolve-FileLock","Safe directory enumerator that uses an explicit stack to walk folders and prunes branches that match skip/protected patterns. Use this instead of Get-ChildItem -Recurse for deletion passes.","Safely consolidates the temporary runtime log into the main log. Uses file-stream copy with backoff and falls back to timestamped archive files or diagnostics if merging fails.","Save-MainLogArchive","Small helper to convert bytes to human-friendly MB/GB strings for output.","Test-FileLock","Test-IsProtectedPath","Test-IsSkipPath","Test-PendingReboot","This page lists helper functions used by Win-Storage-Remediate.ps1 with a short description. Use these helpers when writing tests or adapting the script.","Wait-ForDISM","Waits for any concurrent dism.exe processes to finish with a timeout.","Walks a directory tree (pruned) and reports on locked files; used to diagnose and optionally handle locked log files.","Wrapper around wevtutil epl to export event logs with fallbacks for problematic channel names and quoted argument invocation.","Write-CustomMessage"]}],[{"l":"Troubleshooting & Logging","p":["Primary logs: the script writes a consolidated log to %TEMP%\\scriptName.log(typically %TEMP%\\Win-Storage-Remediate.log) and a temp log %TEMP%\\scriptName_temp.log during execution. On failure the script writes archive diagnostics into the %TEMP%\\ArchivedLogs folder.","If a remediation run appears to do nothing, check the detection script output first (detection returns exit codes). Then inspect the device logs under the user's TEMP and System TEMP ( C:\\Windows\\Temp) and the archive folder for diagnostic files.","For troubleshooting, run the remediation script manually with -DryRun -Verbosity Verbose and review the transcript/log file. Also check event viewer for related errors."]}],[{"l":"References","p":["Microsoft Documentation Links relevant to these scripts","Detection Script documentation","Remediation Script documentation","General References"]},{"l":"Microsoft Documentation Links relevant to these scripts","p":["Intune Management Extension - Microsoft Docs"]},{"l":"Detection Script documentation","p":["Event Logs: Used for evaluating storage space.","Get-ChildItem: Retrieves file system objects."]},{"l":"Remediation Script documentation","p":["Application and Service Logs: Details about application and service logs.","CleanMgr Cleanup:","CleanMgr: Command-line options for disk cleanup.","DISM Cleanup: Cleans up the WinSxS component store.","DISM Component Store Cleanup:","Event Log Cleanup:","Logging:","Old User Profile Cleanup:","PowerShell Event Logging: Logs PowerShell events.","PowerShell Logging: Captures logs using Start-Transcript.","Remove User Profiles: Deletes old user profiles.","Remove-Item: Deletes temporary files.","Storage Sense Cleanup:","Storage Sense: Configures and triggers cleanup of temporary files and OneDrive content.","User-Specific Temporary File Cleanup:","wevtutil: Exports and clears event logs."]},{"l":"General References","p":["Task Scheduler Logs: Logs related to scheduled tasks.","Windows Update Logs: Logs related to Windows updates.","Windows Defender Logs: Logs related to Windows Defender.","Group Policy Logs: Logs related to Group Policy."]}],[{"l":"Changelog","p":["26/10/2025:","18/10/2025:","17/10/2025:","1/07/2025:","10/05/2025:"]},{"l":"26/10/2025:","p":["Added a DISM safety wrapper ( Invoke-DISM-Safe) which respects pending reboot detection and optionally runs when -ForceDISMWhenPending is supplied. Its exit codes and results are logged explicitly.","Added runtime safety switches and modes: -DryRun, -SKIP_SLOW_IO, -CleanMgrOnly, -Estimate, -ForceDISMWhenPending, and -Verbosity(ValidateSet: Silent, Normal, Verbose). These provide non-destructive testing, opt-outs for long I/O, narrow testing modes and controlled DISM behaviour when a reboot is pending.","Added small utility wrappers: Invoke-RemoveWithRetry, Get-SafeChildItems(enumeration with skip rules), and Invoke-WithRetry to standardise retry/backoff behaviour across the script.","Added time-budgeting controls (configurable $MaxCleanupDurationMinutes) for long enumerations so the script cannot run indefinitely on slow or locked file trees.","Centralised temporary and main logs with Start-Transcript and Write-Log.","Consolidation of temporary logs into the main log made DryRun-aware and simplified for robust parsing and token-checker compatibility.","Exposed configuration variables and parameters for Intune-friendly usage; documented behaviour for Proactive Remediations and non-PR deployment scenarios.","Fixed catch/string interpolation to use explicit formatting and avoid invalid variable-colon interpolation.","Hardened logging and archival:","Hardened Win-Storage-Remediate.ps1 for Intune/Proactive Remediations and safety-first automated deployment. Key changes:","Implemented aggressive and conservative skip rules for OneDrive / ODL and other protected paths via a curated $skipPathPatterns list to avoid deleting synced or important files.","Implemented robust per-item retry/backoff logic for file and directory removals and other IO operations to tolerate transient locks and reduce partial failures.","Performed linter-focused fixes and naming improvements to satisfy PSScriptAnalyzer guidance:","Prefer atomic archival via Move-Item into per-run archives; fallback to append+truncate into a single archive file, and final fallback diagnostic .diag.txt when archive operations fail.","Removed or repaired small corrupted/escaped fragments and ensured the script is accepted by the PowerShell parser (parser API) while further token-level scanner cleanups are in progress.","Replaced an unapproved verb name ( Sweep-BrowserCache-AllUsers) with an approved verb ( Clear-BrowserCacheAllUsers).","Silenced unused-variable warnings via intentional no-op references where variables are retained for future tuning (for example $null = $MaxCleanupDurationMinutes, $null = $skipPathPatterns).","Simplified and stabilised the final log-consolidation/archival region (previously a complex pipeline) to a conservative Read→Add-Content -Value→Remove-Item flow to avoid tokenisation/parser sensitivity in repository tooling."]},{"l":"18/10/2025:","p":["Reorganized all functions to be placed at the top of the script, immediately after the variables and before any code execution.","Grouped related sections of the main script logic into logical blocks for better readability and maintainability.","Ensured Disk Cleanup GUI suppression logic is placed near the Disk Cleanup execution section.","Consolidated log handling and finalization steps into a dedicated section at the end of the script.","Improved overall script structure to ensure logical order of operations and maintainability."]},{"l":"17/10/2025:","p":["$cleanupTypeSelection: Categories for CleanMgr cleanup.","$logsToClear: List of event logs to process.","$oneDriveCleanupThreshold: Threshold for OneDrive content cleanup.","$userProfileRetentionDays: Retention period for user profiles.","0 = Success (normal completion).","1 = General failure (useful for external monitoring; individual step failures do not necessarily change the final exit code unless a fatal condition is detected).","Added DISM component store cleanup (StartComponentCleanup) with explicit exit-code logging.","Added initialisation of $freeSpaceGB to capture baseline free space before cleanup, ensuring accurate space-recovered reporting.","Added removal of old user profiles from C:\\Users based on retention days ($userProfileRetentionDays).","Added removal of user-specific temporary files (%USERPROFILE%\\AppData\\Local\\Temp).","Centralised logging with Start-Transcript and Write-Log; log file located at $env:TEMP<scriptName>.log.","Cleared logs using wevtutil cl after successful export.","Configured and triggered Storage Sense to remove temporary files and locally cached OneDrive content.","Documented exit codes:","Enhanced event log cleanup:","Exported logs to an archive directory ($env:TEMP\\EventLogArchives) using wevtutil epl.","Exposed configuration variables for operational tuning:","Improved error handling for individual logs to ensure the script continues processing other logs.","Improved error handling so individual step failures are logged as warnings and the script continues.","Integrated CleanMgr registry preparation for selected VolumeCaches and invoked CleanMgr (/sagerun:1).","Known issues (as-written):","Logged the location of exported logs for archival purposes.","None identified after recent updates."]},{"l":"1/07/2025:","p":["Major update","Improved documentation and logging output, especially if run manually at command line","Additional space gains by targeting Temporary files, and unused local OneDrive files via Storage Sense","Cleans up superseded Windows Update components from local device"]},{"l":"10/05/2025:","p":["Initial version"]}],[{"l":"M365-Version Intune Remediation"},{"l":"Table of Contents","p":["Purpose","Overview","Dependencies","Detection Script","Remediation Script","Usage","Inputs","Outputs","Notes"]},{"l":"Purpose","p":["Documents both the detection and remediation scripts for Microsoft 365 Apps version compliance via Intune Remediation."]},{"l":"Overview","p":["This page covers both:","Detection script: Determines if Microsoft 365 Apps is at the required Monthly Enterprise version, using robust scheduling and compliance logic.","Remediation script: Updates Microsoft 365 Apps to the required version, with user-friendly prompts and safe update handling."]},{"l":"Dependencies","p":["PowerShell 7+","Internet access (for version checks and update downloads)","Windows OS with Microsoft 365 Apps installed","Access to registry: HKLM:\\SOFTWARE\\Microsoft\\Office\\ClickToRun\\Configuration","expand.exe(built-in)","Office Deployment Tool Configuration Options","Monthly Enterprise Channel Release Notes"]},{"l":"Detection Script","p":["Logic:","Runs only on scheduled days, based on device hostname and day of week.","Retrieves the installed Office build version from the registry.","Fetches the latest Monthly Enterprise build version from Microsoft (via ofl.cab or web fallback).","Compares installed and required versions.","Returns exit codes:","0: Compliant","1: Non-compliant (requires remediation)","2: Off-schedule (skipped)","4: Unidentifiable target group (symbol in device name)","Inputs: None required; uses environment and registry.","Outputs: Compliance status, installed and required version, detailed log file in %TEMP%.","Documentation:","Get-ItemProperty","PowerShell Exit Codes"]},{"l":"Remediation Script","p":["Logic:","Checks installed and latest required build versions.","If update is needed:","Detects running Office apps and prompts user (toast notification) to close them, with up to 2 reminders.","Proceeds with update after reminders or if user closes apps.","Runs OfficeC2RClient.exe to update to the required version, using non-disruptive flags.","Logs all actions and outcomes.","Inputs: None required; uses environment and registry.","Outputs: Actions taken, update status, user prompts, detailed log file in %TEMP%.","Documentation:","Update Options for Office 365 ProPlus","Office Deployment Tool Configuration Options"]},{"l":"Usage","p":["Both scripts are deployed as part of an Intune Remediation package.","Detection runs first; if non-compliant, remediation is triggered."]},{"l":"Inputs","p":["No external parameters; all logic is self-contained."]},{"l":"Outputs","p":["Detection: Compliance status, installed/required version, log file.","Remediation: Actions taken, user prompts, update status, log file."]},{"l":"Notes","p":["Scheduling logic ensures devices are checked on a rolling basis.","User experience is prioritised: update is non-disruptive, with clear prompts.","See project standards for logging, error handling, and accessibility."]}],[{"l":"Teams-Old Intune Remediation","p":["Old versions of Teams across your enterprise - ick.","If you're using Intune, let's banish these in from your computers way that doesn't get in the way of the user (especially when they're on a call)."]},{"l":"Table of Contents","p":["Purpose","Overview","Dependencies","Detection Script","Remediation Script","Usage","Inputs","Outputs","Notes"]},{"l":"Purpose","p":["Documents both the detection and remediation scripts for legacy Microsoft Teams installations via Intune Remediation."]},{"l":"Overview","p":["This page covers both:","Detection script: Identifies legacy (non-AppX/MSIX) Teams installations, including Classic Teams, New Teams (per-user), and Teams Personal, and determines if remediation is required.","Remediation script: Removes legacy Teams (Classic, New, Personal), uninstalls non-AppX Teams, and removes Teams Personal AppX packages if present."]},{"l":"Dependencies","p":["PowerShell 7+","Windows OS","Internet access (for AppX queries)","Access to registry and file system","Get-AppxPackage","Remove-AppxPackage","New Teams bulk install"]},{"l":"Detection Script","p":["0: Compliant","1: Non-compliant (remediation required)","2: Off-schedule","3: User in Teams call/meeting","4: Device name ends in symbol (manual remediation)","Checks if Teams is running or user is in a call/meeting (skips if so).","Classic Teams (per-user and machine-wide)","Compliant if only Org Teams AppX/MSIX present","Detects:","Determines compliance:","Documentation:","Exit codes:","Get-AppxPackage","Inputs: None required; uses environment, registry, and file system.","Logic:","New Teams (per-user)","Non-compliant if any legacy (non-AppX/MSIX) Teams found","Outputs: Compliance status, details of detected Teams installations, log file in %TEMP%.","Teams AppX/MSIX (Org and Personal)","Validates device name and scheduled remediation day (spread scheduling by hostname)."]},{"l":"Remediation Script","p":["Logic:","Aborts if non-AppX Teams is running or user is in a Teams call/meeting (exit 3).","Removes legacy Teams folders (per-user and machine-wide).","Uninstalls non-AppX Teams via registry (excluding Office add-in).","Removes Teams Personal AppX packages for all users.","Logs all actions to %TEMP%\\TeamsRemediation.log.","Exit codes:","0: Success","3: User in Teams call/meeting (skipped)","Inputs: None required; uses environment, registry, and file system.","Outputs: Actions taken, uninstall results, log file in %TEMP%.","Documentation:","Remove-AppxPackage","New Teams bulk install"]},{"l":"Usage","p":["Both scripts are deployed as part of an Intune Remediation package.","Detection runs first; if legacy Teams is found, remediation is triggered."]},{"l":"Inputs","p":["No external parameters; all logic is self-contained."]},{"l":"Outputs","p":["Detection: Presence and details of legacy Teams, compliance status, log file.","Remediation: Actions taken, uninstall results, log file."]},{"l":"Notes","p":["See project standards for logging, error handling, and accessibility."]}],[{"l":"WinUpdate-23H2to24H2Force Intune Remediation"},{"l":"Table of Contents","p":["Purpose","Overview","Dependencies","Detection Script","Remediation Script","Usage","Inputs","Outputs","Notes"]},{"l":"Purpose","p":["Documents both the detection and remediation scripts for forcing Windows update from 23H2 to 24H2 via Intune Remediation."]},{"l":"Overview","p":["This page covers both:","Detection script: Checks if device is running Windows 11 23H2 and is targeted for update, using hostname and day-of-week logic. Determines if update to 24H2 is required.","Remediation script: Downloads and installs the 24H2 enablement package if required, and schedules a reboot with user notifications."]},{"l":"Dependencies","p":["PowerShell 7+","Windows 11 23H2 (targeted devices)","Internet access (for package download)","Access to registry: HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion","Get-ItemProperty","Invoke-WebRequest","New-ScheduledTaskAction"]},{"l":"Detection Script","p":["Logic:","Validates targeting by day of week and device hostname (spread scheduling).","Checks if device is running Windows 11 23H2 or 24H2.","Exit codes:","0: Compliant (already on 24H2, not targeted, or unsupported)","1: Not compliant (device is 23H2 and targeted for update)","2: Error or unsupported architecture/version","Inputs: None required; uses environment and registry.","Outputs: Compliance status, OS version, log/output to console.","Documentation:","Get-ItemProperty"]},{"l":"Remediation Script","p":["Logic:","Validates targeting by day of week and device hostname (spread scheduling).","Checks if device is running Windows 11 23H2 (build 22631).","Downloads the 24H2 enablement package for the correct architecture (x64/ARM64).","Installs the package silently using wusa.exe.","Schedules a reboot with user notifications (toast popups, 15 min and 2 min warnings) via a scheduled task and PowerShell script.","Logs all actions to %ProgramData%\\Intune-Win11-24H2-Enablement.log.","Exit codes:","0: Success","2: Error or unsupported architecture/version","Inputs: None required; uses environment and registry.","Outputs: Actions taken, install results, log file in %ProgramData%.","Documentation:","Invoke-WebRequest","New-ScheduledTaskAction"]},{"l":"Usage","p":["Both scripts are deployed as part of an Intune Remediation package.","Detection runs first; if update is needed, remediation is triggered."]},{"l":"Inputs","p":["No external parameters; all logic is self-contained."]},{"l":"Outputs","p":["Detection: Update readiness/status, OS version, log/output.","Remediation: Actions taken, install results, log file."]},{"l":"Notes","p":["See project standards for logging, error handling, and accessibility."]}],[{"l":"WinUpdate-Outstanding Intune Remediation"},{"l":"Table of Contents","p":["Purpose","Overview","Dependencies","Detection Script","Remediation Script","Usage","Inputs","Outputs","Notes"]},{"l":"Purpose","p":["Documents both the detection and remediation scripts for outstanding Windows Updates via Intune Remediation."]},{"l":"Overview","p":["This page covers both:","Detection script: Checks for outstanding Windows Updates by OS version, last update date, and spread scheduling logic.","Remediation script: Repairs Windows Update components, removes update pauses, and resets update-related registry keys to allow updates to proceed."]},{"l":"Dependencies","p":["PowerShell 7+","Windows 10/11","Access to registry and WMI","Get-ComputerInfo","Get-HotFix","Repair-WindowsImage"]},{"l":"Detection Script","p":["0: Compliant (up to date), or device not targeted for today (skipped)","1: Non-compliant (outstanding updates, outdated OS, or last update too old)","Compliance status (compliant, non-compliant, or skipped)","Documentation:","Exit codes:","Get-ComputerInfo","Get-HotFix","If OS version is outdated or last update is too old (≥40 days), marks as non-compliant.","If the device is not targeted for the current day, the script exits immediately with code 0(compliant/skipped).","If the device is targeted, the script checks:","If the last character is a digit, only certain digits are allowed on each weekday (e.g., 0/1 on Monday, 2/3 on Tuesday, etc.).","If the last character is a letter, only devices ending with a letter are targeted on Fridays.","Inputs: None required; uses environment, registry, and WMI.","Last update date","Last update date using Get-HotFix.","Log/output to console","Logic:","OS version","OS version (Windows 10/11) against the current expected build.","Outputs:","Targeting logic (spread scheduling):","The current day of the week (Monday–Friday only; weekends are always skipped).","The last character of the device hostname:","The script determines if the device should be evaluated for outstanding updates on a given day, based on:","Update compliance check:"]},{"l":"Remediation Script","p":["0: Success","1: Error","Actions taken (step-by-step log)","All actions are logged to the console and, where applicable, to log files.","Also resets update deferral and telemetry settings as needed.","Checks for fast boot and calculates true uptime.","Create Diagnostic Logs:","Creates a scheduled task to reboot the device at midnight if it has not rebooted in the last day.","Data Collection and Appraiser Registry:","Deletes or resets keys and values under:","Deletes qmgr*.dat files to clear BITS job queue.","Deletes these folders to reset Windows Update state.","Diagnostic logs","Documentation:","Downloads and runs SetupDiag to collect update diagnostics, saving logs to the Intune Management Extension logs folder.","Ensures telemetry/compatibility settings are enabled for update eligibility.","Executes Repair-WindowsImage -RestoreHealth to repair system image corruption.","Exit codes:","Force Update Discovery:","HKLM:\\SOFTWARE\\Microsoft\\PolicyManager\\current\\device\\Update(removes pause dates, sets status values to 0)","HKLM:\\SOFTWARE\\Microsoft\\WindowsUpdate\\UpdatePolicy\\Settings(removes pause dates/status, sets status values to 0)","HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate","If a reboot is needed, schedules shutdown.exe with a 15-minute warning and a user notification (toast message) instructing users to save work.","Inputs: None required; uses environment and registry.","Log/output","Logic:","Outputs:","Pause for 5 Minutes:","Re-register Windows Update DLLs:","Registers a comprehensive list of DLLs required for Windows Update using regsvr32.exe.","Registry and file changes","Remove QMGR Data Files:","Remove SoftwareDistribution and CatRoot2 Folders:","Remove Update Pause and Policy Registry Keys:","Repair-WindowsImage","Reset Service Permissions:","Reset WinSock:","Resets permissions for BITS and wuauserv using sc.exe sdset.","Restart Windows Update Services:","Run DISM Repair:","Runs netsh winsock reset to repair network stack issues.","Runs USOClient.exe StartInteractiveScan to trigger update scan.","Schedule Midnight Reboot (if needed):","Scheduled reboot status","Sets or creates values under HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection and HKLM:SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\Appraiser\\GWX.","Starts BITS, wuauserv, and cryptsvc services.","Stop Windows Update Services:","Stops BITS, wuauserv, and cryptsvc services.","The notification message is: \"Your computer will restart in 15 minutes to install Windows updates - Please save your work now. Submit an ICT Service Desk ticket if this prompt has been displayed three or more days in a row.\"","The remediation script performs a comprehensive reset and repair of Windows Update components, following these steps:","Waits 5 minutes to allow update processes to settle."]},{"l":"Usage","p":["Both scripts are deployed as part of an Intune Remediation package.","Detection runs first; if updates are outstanding, remediation is triggered."]},{"l":"Inputs","p":["No external parameters; all logic is self-contained."]},{"l":"Outputs","p":["Detection: Update status, OS version, last update date, log/output.","Remediation: Actions taken, registry changes, log/output."]},{"l":"Notes","p":["See project standards for logging, error handling, and accessibility."]}],[{"l":"WinUpdate-Pause Intune Remediation"},{"l":"Purpose","p":["Documents both the detection and remediation scripts for paused Windows Update status via Intune Remediation."]},{"l":"Overview","p":["This page covers both:","Detection script: Detects if Windows Update is paused by checking registry values and policy keys, with targeting logic to spread load.","Remediation script: Removes pause-related registry values and policies, restarts update services, and triggers update scan/install."]},{"l":"Detection Script","p":["Checks for:","Compliance status (paused or not paused)","Existence of PauseStartTime in the same key","If any are found, considers Windows Update paused and exits with code 1(non-compliant).","If not targeted, exits with code 0(compliant/skipped).","Inputs: None required; uses environment and registry.","Log/output to console","Logic:","Only runs on weekdays (Monday–Friday).","Otherwise, exits with code 0(compliant).","Outputs:","Pause detection:","PauseUpdates=1 in HKLM:\\SOFTWARE\\Microsoft\\WindowsUpdate\\UX\\Settings","Reasons for pause (if detected)","SetDisablePauseUXAccess=0 in HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate","Targeting logic (spread scheduling):","Uses the last character of the device hostname and the day of week to determine if the device is targeted for this run."]},{"l":"Remediation Script","p":["Logic:","Removes pause-related registry values from HKLM:\\SOFTWARE\\Microsoft\\WindowsUpdate\\UX\\Settings:","PauseUpdates","PauseStartTime","PauseEndTime","Removes SetDisablePauseUXAccess from HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate if present.","Restarts Windows Update services ( wuauserv, bits).","Triggers a Windows Update scan and attempts to install available updates using the Windows Update COM API.","Logs all actions and results.","Exits with code 0 on success, 1 on error.","Inputs: None required; uses environment and registry.","Outputs:","Actions taken (registry changes, service restarts, update scan/install)","Log/output to console"]},{"l":"Usage","p":["Both scripts are deployed as part of an Intune Remediation package.","Detection runs first; if update is paused, remediation is triggered."]},{"l":"Inputs","p":["No external parameters; all logic is self-contained."]},{"l":"Outputs","p":["Detection: Pause status, reasons, log/output.","Remediation: Actions taken, log/output."]},{"l":"Notes","p":["See project standards for logging, error handling, and accessibility."]}],[{"l":"Uploading and downloading contact to Sharepoint or Onedrive","p":["tl,dr: Don't write your own script - just use rclone, available from: https://rclone.org/","rclone will:","is FOSS","supports numerous cloud services.","work cross-platform with ease (pick your OS)","allows you to upload, download and sync","supports maintaining directory paths"]},{"l":"Quick steps","p":["This is a good visual guide for setup: Connecting to OneDrive with RClone - Murray's Blog"]},{"l":"Copy (upload) files","p":["--check-first","--inplace","--metadata","-i","-P","-v","A quick summary of the steps:","Accept defaults for tenant","Accepting defaults for client_id, client_secret","Change directory to where rclone.exe is located, and run:","Command breakdown:","Create the config, by:","Do all the checks before starting transfers","Do not edit advanced config","Download directly to destination file instead of atomic download to temp/rename","Enable interactive mode","Enter q to quit","Enter y, or press enter to keep the remote","Enter y, or press enter to save config","Giving it a name,","If set, preserve metadata when copying objects","Other command switches can be found at: https://rclone.org/commands/rclone_copy/#copy-options","Print lots more stuff (repeat for more)","Purpose","Select correct region for your tenant","Select the correct type of connection for what you are setting up (1 for OneDrive Personal or Business, etc). Options will be available to search for a OneDrive driveid or SharePoint site if needed.","Select the drive you want to use (always select the one named OneDrive (business))","Select the option to make a new remote","Selecting correct storage option (38 for OneDrive/SharePoint at time of writing)","Start uploading your content:","Switch","Test the config by connecting to your new share, with this command:","Use the web browser to automatically authenticate with your remote, and complete the authentication and permission steps.","View real-time transfer statistics"]}],[{"l":"Donations and thank you's","p":["Like to say thank you?"]},{"l":"Like to say thank you?","p":["Feel welcome to:","Buy me a ko-fi"]}]]